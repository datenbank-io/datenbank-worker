machine:
  services:
    - docker
dependencies:
  pre:
    - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
    - docker build --rm=false -t datenbank/worker:$CIRCLE_BRANCH-${CIRCLE_SHA1:0:7} .
    - docker push datenbank/worker:$CIRCLE_BRANCH-${CIRCLE_SHA1:0:7}
deployment:
  release:
    tag: /release-.*/
    owner: datenbank-io
    commands:
      - echo "release"
  development:
    branch: development
    commands:
      - aws configure set region eu-central-1
      - ./deploy.sh